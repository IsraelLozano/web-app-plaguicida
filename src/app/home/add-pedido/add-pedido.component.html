<mat-card>
  <mat-card-content>
    <form #invoiceForm="ngForm">
      <div fxLayout="row wrap" class="align-items-center m-b-15">
        <div fxFlex.gt-md="25" fxFlex.gt-lg="25" fxFlex="100">
          <h3 class="m-0">
            # <span name="id" ngDefaultControl> {{ idPedido }}</span>
          </h3>
        </div>
        <div fxFlex.gt-md="75" class="text-right">
          <a routerLink="/home/portalacademico">
            <button mat-stroked-button color="warn" class="m-r-10">Regresar</button>
          </a>
          <button mat-raised-button color="primary" (click)="saveDetail()" [disabled]="addForm.invalid">
            <mat-icon class="mat-18">save</mat-icon>
            Grabar
          </button>
        </div>
      </div>

      <hr />

      <!-- <div fxLayout="row wrap" class="align-items-center m-t-30 m-b-15">
        <div fxFlex="100" fxFlex.gt-md="50">
          <mat-form-field class="p-r-15 m-r-15">
            <mat-label>Articulo</mat-label>
            <input matInput placeholder="Bill From" name="from" />
          </mat-form-field>
        </div>

      </div> -->
    </form>

    <div [formGroup]="addForm">
      <div class="table-responsive">
        <!-- <table class="table table-hover border-all no-wrap v-middle"> -->
        <!-- <table class="table ticket-list"> -->
        <table class="table table-hover border-all no-wrap v-middle">
          <thead>
            <tr>
              <th>#</th>
              <th width="40%">Articulo</th>
              <th>P.U</th>
              <th>Cantidad</th>
              <th>Importe</th>
              <th>% Part</th>
              <th>% Comision</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let row of addForm.get('rows')?.controls; let index = index">
              <td class="p-10 font-12">{{ index + 1 }}</td>

              <td class="p-10">
                <!-- <input matInput placeholder="Ingrese Articulo" aria-label="Camoens" [matAutocomplete]="articulos" class="form-control font-12" style="line-height: 18px !important;" />
                <mat-autocomplete #articulos="matAutocomplete" (optionSelected)="onSelectionChange($event)">
                  <mat-option *ngFor="let option of filterStates()" [value]="option">
                    {{ option.NomArticulo }}
                  </mat-option>
                </mat-autocomplete> -->
                <input matInput placeholder="Ingrese Articulo" aria-label="Camoens" [formControl]="row.get('itemName')" [matAutocomplete]="autostart" class="form-control font-12" name="txt-{{index}}"
                  style="line-height: 18px !important;" />
                <mat-autocomplete #autostart="matAutocomplete"  [displayWith]="displayFn" (optionSelected)="onSelectionChange($event, row)">
                  <mat-option *ngFor="let option of filterStates('a') " [value]="option">
                    {{ option.NomArticulo }}
                  </mat-option>
                </mat-autocomplete>

                <!-- <input type="text" class="form-control font-12" [formControl]="row.get('itemName')"
                  (input)="itemsChanged()" style="line-height: 18px !important;" /> -->
              </td>

              <td class="p-10">
                <input type="number" class="form-control font-12 text-right" disabled [formControl]="row.get('unitPrice')" name="txt-unitPrice-{{index}}"
                  style="line-height: 18px;" />
              </td>

              <td class="p-10">
                <input type="number" class="form-control font-12 text-center" min="1" [formControl]="row.get('units')" name="txt-units-{{index}}"
                  (input)="itemsChanged()" style="line-height: 18px;" />
              </td>

              <td class="p-10">
                <input disabled class="form-control font-12 text-right" [formControl]="row.get('itemTotal')" name="txt-itemTotal-{{index}}"
                  [value]="row.get('unitPrice').value * row.get('units').value" style="line-height: 18px;" />
              </td>

              <td class="p-10">
                <input disabled  type="number" class="form-control font-12 text-center" name="txt-participacion-{{index}}"
                  [formControl]="row.get('participacion')" style="line-height: 18px;" />
              </td>

              <td class="p-10">
                <input disabled type="number" class="form-control font-12 text-center" name="txt-comision-{{index}}"
                  [formControl]="row.get('comision')" style="line-height: 18px;" />
              </td>

              <td class="p-10">
                <div *ngIf="index > 0">
                  <button color="warn" mat-raised-button (click)="onRemoveRow(index)">
                    <mat-icon class="mat-18">delete_outline</mat-icon>
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="text-right m-t-30">
        <button color="accent" mat-raised-button (click)="onAddRow()" [disabled]="addForm.invalid" *ngIf="addForm.get('rows')">
          <mat-icon>add</mat-icon>
          Agregar
        </button>

        <h5 class="m-b-5 font-medium">Total: {{ subTotal | number: '1.2-2'}}</h5>
        <h5 class="m-t-0 font-medium">Total Comision %: {{ totalComision | number: '1.3-3'}}</h5>

        <h3 class="m-b-0 b-t p-t-20">Total Comision US$: {{ totalComisionDolares | number: '1.2-2' }}</h3>
      </div>
    </div>
  </mat-card-content>
</mat-card>
